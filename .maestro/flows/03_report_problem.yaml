# Report Problem Flow - Smoke Test
# Tests: User can report a new problem
# Prerequisites: User must be on the problems page (logged in, event selected)
# Tags: smoke, problems

appId: com.brianrosen.stripcall
tags:
  - smoke
  - problems

---
# Ensure we're on the problems page
- assertVisible:
    id: "problems_report_button"

# Tap report button to open new problem dialog
- tapOn:
    id: "problems_report_button"

# Wait for dialog to appear
- waitForAnimationToEnd
- extendedWaitUntil:
    visible:
      id: "new_problem_dialog"
    timeout: 5000

# Step 1: Select the first crew radio button
- tapOn:
    id: "new_problem_crew_radio_.*"
    index: 0
- waitForAnimationToEnd

# Step 2: Select strip 1
- tapOn:
    text: "1"
    index: 0
- waitForAnimationToEnd

# Step 3: Select symptom class - tap dropdown then select "Weapon Issue"
- tapOn:
    id: "new_problem_symptom_class_dropdown"
- waitForAnimationToEnd
- tapOn:
    text: "Weapon Issue"
- waitForAnimationToEnd

# Step 4: Select symptom - tap dropdown then select "Blade broken"
- tapOn:
    id: "new_problem_symptom_dropdown"
- waitForAnimationToEnd
- tapOn:
    text: "Blade broken"

# Step 5: Submit the problem
- waitForAnimationToEnd
- tapOn:
    text: "Submit"

# Wait for dialog to close
- waitForAnimationToEnd
- extendedWaitUntil:
    visible:
      id: "problems_report_button"
    timeout: 10000

# Verify we're back on problems page
- assertVisible:
    id: "problems_report_button"
